{"ast":null,"code":"var AWS = require('../core');\n\nvar rdsutil = {\n  /**\n    * @api private\n    */\n  setupRequestListeners: function setupRequestListeners(service, request, crossRegionOperations) {\n    if (crossRegionOperations.indexOf(request.operation) !== -1 && request.params.SourceRegion) {\n      request.params = AWS.util.copy(request.params);\n\n      if (request.params.PreSignedUrl || request.params.SourceRegion === service.config.region) {\n        delete request.params.SourceRegion;\n      } else {\n        var doesParamValidation = !!service.config.paramValidation; // remove the validate parameters listener so we can re-add it after we build the URL\n\n        if (doesParamValidation) {\n          request.removeListener('validate', AWS.EventListeners.Core.VALIDATE_PARAMETERS);\n        }\n\n        request.onAsync('validate', rdsutil.buildCrossRegionPresignedUrl);\n\n        if (doesParamValidation) {\n          request.addListener('validate', AWS.EventListeners.Core.VALIDATE_PARAMETERS);\n        }\n      }\n    }\n  },\n\n  /**\n   * @api private\n   */\n  buildCrossRegionPresignedUrl: function buildCrossRegionPresignedUrl(req, done) {\n    var config = AWS.util.copy(req.service.config);\n    config.region = req.params.SourceRegion;\n    delete req.params.SourceRegion;\n    delete config.endpoint; // relevant params for the operation will already be in req.params\n\n    delete config.params;\n    config.signatureVersion = 'v4';\n    var destinationRegion = req.service.config.region;\n    var svc = new req.service.constructor(config);\n    var newReq = svc[req.operation](AWS.util.copy(req.params));\n    newReq.on('build', function addDestinationRegionParam(request) {\n      var httpRequest = request.httpRequest;\n      httpRequest.params.DestinationRegion = destinationRegion;\n      httpRequest.body = AWS.util.queryParamsToString(httpRequest.params);\n    });\n    newReq.presign(function (err, url) {\n      if (err) done(err);else {\n        req.params.PreSignedUrl = url;\n        done();\n      }\n    });\n  }\n};\n/**\n * @api private\n */\n\nmodule.exports = rdsutil;","map":{"version":3,"names":["AWS","require","rdsutil","setupRequestListeners","service","request","crossRegionOperations","indexOf","operation","params","SourceRegion","util","copy","PreSignedUrl","config","region","doesParamValidation","paramValidation","removeListener","EventListeners","Core","VALIDATE_PARAMETERS","onAsync","buildCrossRegionPresignedUrl","addListener","req","done","endpoint","signatureVersion","destinationRegion","svc","constructor","newReq","on","addDestinationRegionParam","httpRequest","DestinationRegion","body","queryParamsToString","presign","err","url","module","exports"],"sources":["/Users/lazarbogdan/test/medicacasa-frontend/node_modules/aws-sdk/lib/services/rdsutil.js"],"sourcesContent":["var AWS = require('../core');\n\nvar rdsutil = {\n  /**\n    * @api private\n    */\n   setupRequestListeners: function setupRequestListeners(service, request, crossRegionOperations) {\n    if (crossRegionOperations.indexOf(request.operation) !== -1 &&\n        request.params.SourceRegion) {\n      request.params = AWS.util.copy(request.params);\n      if (request.params.PreSignedUrl ||\n          request.params.SourceRegion === service.config.region) {\n        delete request.params.SourceRegion;\n      } else {\n        var doesParamValidation = !!service.config.paramValidation;\n        // remove the validate parameters listener so we can re-add it after we build the URL\n        if (doesParamValidation) {\n          request.removeListener('validate', AWS.EventListeners.Core.VALIDATE_PARAMETERS);\n        }\n        request.onAsync('validate', rdsutil.buildCrossRegionPresignedUrl);\n        if (doesParamValidation) {\n          request.addListener('validate', AWS.EventListeners.Core.VALIDATE_PARAMETERS);\n        }\n      }\n    }\n  },\n\n  /**\n   * @api private\n   */\n  buildCrossRegionPresignedUrl: function buildCrossRegionPresignedUrl(req, done) {\n    var config = AWS.util.copy(req.service.config);\n    config.region = req.params.SourceRegion;\n    delete req.params.SourceRegion;\n    delete config.endpoint;\n    // relevant params for the operation will already be in req.params\n    delete config.params;\n    config.signatureVersion = 'v4';\n    var destinationRegion = req.service.config.region;\n\n    var svc = new req.service.constructor(config);\n    var newReq = svc[req.operation](AWS.util.copy(req.params));\n    newReq.on('build', function addDestinationRegionParam(request) {\n      var httpRequest = request.httpRequest;\n      httpRequest.params.DestinationRegion = destinationRegion;\n      httpRequest.body = AWS.util.queryParamsToString(httpRequest.params);\n    });\n    newReq.presign(function(err, url) {\n      if (err) done(err);\n      else {\n        req.params.PreSignedUrl = url;\n        done();\n      }\n    });\n  }\n};\n\n/**\n * @api private\n */\nmodule.exports = rdsutil;\n"],"mappings":"AAAA,IAAIA,GAAG,GAAGC,OAAO,CAAC,SAAD,CAAjB;;AAEA,IAAIC,OAAO,GAAG;EACZ;AACF;AACA;EACGC,qBAAqB,EAAE,SAASA,qBAAT,CAA+BC,OAA/B,EAAwCC,OAAxC,EAAiDC,qBAAjD,EAAwE;IAC9F,IAAIA,qBAAqB,CAACC,OAAtB,CAA8BF,OAAO,CAACG,SAAtC,MAAqD,CAAC,CAAtD,IACAH,OAAO,CAACI,MAAR,CAAeC,YADnB,EACiC;MAC/BL,OAAO,CAACI,MAAR,GAAiBT,GAAG,CAACW,IAAJ,CAASC,IAAT,CAAcP,OAAO,CAACI,MAAtB,CAAjB;;MACA,IAAIJ,OAAO,CAACI,MAAR,CAAeI,YAAf,IACAR,OAAO,CAACI,MAAR,CAAeC,YAAf,KAAgCN,OAAO,CAACU,MAAR,CAAeC,MADnD,EAC2D;QACzD,OAAOV,OAAO,CAACI,MAAR,CAAeC,YAAtB;MACD,CAHD,MAGO;QACL,IAAIM,mBAAmB,GAAG,CAAC,CAACZ,OAAO,CAACU,MAAR,CAAeG,eAA3C,CADK,CAEL;;QACA,IAAID,mBAAJ,EAAyB;UACvBX,OAAO,CAACa,cAAR,CAAuB,UAAvB,EAAmClB,GAAG,CAACmB,cAAJ,CAAmBC,IAAnB,CAAwBC,mBAA3D;QACD;;QACDhB,OAAO,CAACiB,OAAR,CAAgB,UAAhB,EAA4BpB,OAAO,CAACqB,4BAApC;;QACA,IAAIP,mBAAJ,EAAyB;UACvBX,OAAO,CAACmB,WAAR,CAAoB,UAApB,EAAgCxB,GAAG,CAACmB,cAAJ,CAAmBC,IAAnB,CAAwBC,mBAAxD;QACD;MACF;IACF;EACF,CAvBW;;EAyBZ;AACF;AACA;EACEE,4BAA4B,EAAE,SAASA,4BAAT,CAAsCE,GAAtC,EAA2CC,IAA3C,EAAiD;IAC7E,IAAIZ,MAAM,GAAGd,GAAG,CAACW,IAAJ,CAASC,IAAT,CAAca,GAAG,CAACrB,OAAJ,CAAYU,MAA1B,CAAb;IACAA,MAAM,CAACC,MAAP,GAAgBU,GAAG,CAAChB,MAAJ,CAAWC,YAA3B;IACA,OAAOe,GAAG,CAAChB,MAAJ,CAAWC,YAAlB;IACA,OAAOI,MAAM,CAACa,QAAd,CAJ6E,CAK7E;;IACA,OAAOb,MAAM,CAACL,MAAd;IACAK,MAAM,CAACc,gBAAP,GAA0B,IAA1B;IACA,IAAIC,iBAAiB,GAAGJ,GAAG,CAACrB,OAAJ,CAAYU,MAAZ,CAAmBC,MAA3C;IAEA,IAAIe,GAAG,GAAG,IAAIL,GAAG,CAACrB,OAAJ,CAAY2B,WAAhB,CAA4BjB,MAA5B,CAAV;IACA,IAAIkB,MAAM,GAAGF,GAAG,CAACL,GAAG,CAACjB,SAAL,CAAH,CAAmBR,GAAG,CAACW,IAAJ,CAASC,IAAT,CAAca,GAAG,CAAChB,MAAlB,CAAnB,CAAb;IACAuB,MAAM,CAACC,EAAP,CAAU,OAAV,EAAmB,SAASC,yBAAT,CAAmC7B,OAAnC,EAA4C;MAC7D,IAAI8B,WAAW,GAAG9B,OAAO,CAAC8B,WAA1B;MACAA,WAAW,CAAC1B,MAAZ,CAAmB2B,iBAAnB,GAAuCP,iBAAvC;MACAM,WAAW,CAACE,IAAZ,GAAmBrC,GAAG,CAACW,IAAJ,CAAS2B,mBAAT,CAA6BH,WAAW,CAAC1B,MAAzC,CAAnB;IACD,CAJD;IAKAuB,MAAM,CAACO,OAAP,CAAe,UAASC,GAAT,EAAcC,GAAd,EAAmB;MAChC,IAAID,GAAJ,EAASd,IAAI,CAACc,GAAD,CAAJ,CAAT,KACK;QACHf,GAAG,CAAChB,MAAJ,CAAWI,YAAX,GAA0B4B,GAA1B;QACAf,IAAI;MACL;IACF,CAND;EAOD;AApDW,CAAd;AAuDA;AACA;AACA;;AACAgB,MAAM,CAACC,OAAP,GAAiBzC,OAAjB"},"metadata":{},"sourceType":"script"}