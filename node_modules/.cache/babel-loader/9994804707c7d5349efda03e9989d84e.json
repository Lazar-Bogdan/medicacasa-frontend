{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nimport { useRef, useState, useEffect, useLayoutEffect, useCallback } from \"react\";\nimport { STRATEGY_WHITE_LIST, SSR_ONLY, ON, WHEN_VISIBLE } from \"./constants\";\nimport StrategyTypeError from \"./errors/StrategyTypeError\";\nimport StrategyOptionsError from \"./errors/StategyOptionsError\";\nimport getQAPI from \"../../utils/getQAPI\";\n/**\n * @typedef ON\n * @type { Array<string> | string } events событие или события необходимые для запуска\n * */\n\n/**\n * @typedef WHEN_VISIBLE\n * @type { String } rootMargin\n * @type { Element | Document } root\n * @type { Number | Array<Number> } threshold\n * */\n\nvar getGlobalBrowser = function getGlobalBrowser() {\n  return typeof window === \"undefined\" ? null : window;\n};\n\nvar useIsomorphicLayoutEffect = getGlobalBrowser() ? useLayoutEffect : useEffect;\n/**\n * @template R typeof of ref object\n * @param { String } strategy Стратегия гидрации\n * @param { ON | WHEN_VISIBLE | undefined  } options Опции для стратегии\n * @return @component\n * */\n\nexport var useLazyHydrate = function useLazyHydrate(_ref, ref) {\n  var strategy = _ref.strategy,\n      options = _ref.options;\n\n  if (!STRATEGY_WHITE_LIST.includes(strategy)) {\n    throw new StrategyTypeError(strategy);\n  }\n\n  var qapi = getQAPI();\n  var cleanupFns = useRef(new Set());\n\n  var _useState = useState(qapi.mode === \"development\" || !getGlobalBrowser()),\n      _useState2 = _slicedToArray(_useState, 2),\n      hydrated = _useState2[0],\n      setHydrated = _useState2[1];\n\n  var runHydrate = useCallback(function () {\n    return setHydrated(true);\n  }, []);\n  useIsomorphicLayoutEffect(function () {\n    // No SSR Content\n    if (!ref.current.hasChildNodes()) {\n      setHydrated(true);\n    }\n  }, []);\n  useEffect(function () {\n    if (!hydrated) {\n      return;\n    }\n\n    cleanupFns.current.forEach(function (fn) {\n      return fn();\n    });\n    cleanupFns.current.clear();\n  }, [hydrated]);\n  useEffect(function () {\n    if (hydrated) {\n      return;\n    }\n\n    switch (strategy) {\n      case SSR_ONLY:\n        return;\n\n      case ON:\n        {\n          var events = options.events;\n\n          if (!events) {\n            throw new StrategyOptionsError(strategy, options);\n          }\n\n          if (!Array.isArray(events)) {\n            events = [events];\n          }\n\n          events.forEach(function (event) {\n            return ref.current.addEventListener(event, runHydrate, {\n              once: true,\n              capture: true,\n              passive: true\n            });\n          });\n          events.forEach(function (event) {\n            return cleanupFns.add(function () {\n              return ref.current.removeEventListener(event, runHydrate);\n            });\n          });\n          break;\n        }\n\n      case WHEN_VISIBLE:\n        {\n          var global = getGlobalBrowser();\n\n          if (!global.IntersectionObserver) {\n            console.info(\"IntersectionObserver is not supported by your browser\");\n            return runHydrate();\n          }\n\n          var ioOptions = _objectSpread({\n            root: null,\n            rootMargin: \"150px\"\n          }, options);\n\n          var io = new IntersectionObserver(function (_ref2) {\n            var _ref3 = _slicedToArray(_ref2, 1),\n                entry = _ref3[0];\n\n            return entry.isIntersecting && runHydrate();\n          }, ioOptions);\n          io.observe(ref.current);\n          cleanupFns.current.add(function () {\n            return io.unobserve(ref.current);\n          });\n          break;\n        }\n\n      default:\n        break;\n    }\n\n    return function () {\n      return cleanupFns.current.forEach(function (fn) {\n        return fn();\n      });\n    };\n  }, [strategy, options]);\n  return hydrated;\n};","map":{"version":3,"names":["_defineProperty","_slicedToArray","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","getOwnPropertyDescriptors","defineProperties","defineProperty","useRef","useState","useEffect","useLayoutEffect","useCallback","STRATEGY_WHITE_LIST","SSR_ONLY","ON","WHEN_VISIBLE","StrategyTypeError","StrategyOptionsError","getQAPI","getGlobalBrowser","window","useIsomorphicLayoutEffect","useLazyHydrate","_ref","ref","strategy","options","includes","qapi","cleanupFns","Set","_useState","mode","_useState2","hydrated","setHydrated","runHydrate","current","hasChildNodes","fn","clear","events","Array","isArray","event","addEventListener","once","capture","passive","add","removeEventListener","global","IntersectionObserver","console","info","ioOptions","root","rootMargin","io","_ref2","_ref3","entry","isIntersecting","observe","unobserve"],"sources":["/Users/lazarbogdan/test/medicacasa-frontend/node_modules/@quarkly/components/build/esm/hooks/useLazyHydrate/hook.js"],"sourcesContent":["import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useRef, useState, useEffect, useLayoutEffect, useCallback } from \"react\";\nimport { STRATEGY_WHITE_LIST, SSR_ONLY, ON, WHEN_VISIBLE } from \"./constants\";\nimport StrategyTypeError from \"./errors/StrategyTypeError\";\nimport StrategyOptionsError from \"./errors/StategyOptionsError\";\nimport getQAPI from \"../../utils/getQAPI\";\n/**\n * @typedef ON\n * @type { Array<string> | string } events событие или события необходимые для запуска\n * */\n\n/**\n * @typedef WHEN_VISIBLE\n * @type { String } rootMargin\n * @type { Element | Document } root\n * @type { Number | Array<Number> } threshold\n * */\n\nvar getGlobalBrowser = function getGlobalBrowser() {\n  return typeof window === \"undefined\" ? null : window;\n};\n\nvar useIsomorphicLayoutEffect = getGlobalBrowser() ? useLayoutEffect : useEffect;\n/**\n * @template R typeof of ref object\n * @param { String } strategy Стратегия гидрации\n * @param { ON | WHEN_VISIBLE | undefined  } options Опции для стратегии\n * @return @component\n * */\n\nexport var useLazyHydrate = function useLazyHydrate(_ref, ref) {\n  var strategy = _ref.strategy,\n      options = _ref.options;\n\n  if (!STRATEGY_WHITE_LIST.includes(strategy)) {\n    throw new StrategyTypeError(strategy);\n  }\n\n  var qapi = getQAPI();\n  var cleanupFns = useRef(new Set());\n\n  var _useState = useState(qapi.mode === \"development\" || !getGlobalBrowser()),\n      _useState2 = _slicedToArray(_useState, 2),\n      hydrated = _useState2[0],\n      setHydrated = _useState2[1];\n\n  var runHydrate = useCallback(function () {\n    return setHydrated(true);\n  }, []);\n  useIsomorphicLayoutEffect(function () {\n    // No SSR Content\n    if (!ref.current.hasChildNodes()) {\n      setHydrated(true);\n    }\n  }, []);\n  useEffect(function () {\n    if (!hydrated) {\n      return;\n    }\n\n    cleanupFns.current.forEach(function (fn) {\n      return fn();\n    });\n    cleanupFns.current.clear();\n  }, [hydrated]);\n  useEffect(function () {\n    if (hydrated) {\n      return;\n    }\n\n    switch (strategy) {\n      case SSR_ONLY:\n        return;\n\n      case ON:\n        {\n          var events = options.events;\n\n          if (!events) {\n            throw new StrategyOptionsError(strategy, options);\n          }\n\n          if (!Array.isArray(events)) {\n            events = [events];\n          }\n\n          events.forEach(function (event) {\n            return ref.current.addEventListener(event, runHydrate, {\n              once: true,\n              capture: true,\n              passive: true\n            });\n          });\n          events.forEach(function (event) {\n            return cleanupFns.add(function () {\n              return ref.current.removeEventListener(event, runHydrate);\n            });\n          });\n          break;\n        }\n\n      case WHEN_VISIBLE:\n        {\n          var global = getGlobalBrowser();\n\n          if (!global.IntersectionObserver) {\n            console.info(\"IntersectionObserver is not supported by your browser\");\n            return runHydrate();\n          }\n\n          var ioOptions = _objectSpread({\n            root: null,\n            rootMargin: \"150px\"\n          }, options);\n\n          var io = new IntersectionObserver(function (_ref2) {\n            var _ref3 = _slicedToArray(_ref2, 1),\n                entry = _ref3[0];\n\n            return entry.isIntersecting && runHydrate();\n          }, ioOptions);\n          io.observe(ref.current);\n          cleanupFns.current.add(function () {\n            return io.unobserve(ref.current);\n          });\n          break;\n        }\n\n      default:\n        break;\n    }\n\n    return function () {\n      return cleanupFns.current.forEach(function (fn) {\n        return fn();\n      });\n    };\n  }, [strategy, options]);\n  return hydrated;\n};"],"mappings":"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"},"metadata":{},"sourceType":"module"}